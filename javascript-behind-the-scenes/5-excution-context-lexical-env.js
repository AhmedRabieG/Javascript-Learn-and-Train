
// Execution context , lexical environment , global excution context  

// Execution Context ุงูู ูู ุงู ุ
// ุงู Execution Context ูู ุงูุจูุฆุฉ ุงููู ุจูุชู ูููุง ุชูููุฐ ุงูููุฏ ุจุชุงุนู
// ูุจูุญุชูู ุนูู ูุนูููุงุช ุนู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู scope ุงูุญุงูู
// ูุจูุชู ุงูุดุงุก Execution Context ุฌุฏูุฏ ููู ุฏุงูุฉ ุจุชุชููุฐ ูู ุงูุจุฑูุงูุฌ ุจุชุงุนู
// ูุจูููู ุจุชูููุฐ ุงูููุฏ ุจุชุงุนูุง ูู ุงู Execution Context ุงูุญุงูู

// ) ูุฑุงุญู ุงูู Execution Context (ุจุณุทุฑูู ููููู)
// ุนูุฏ ุฅูุดุงุก EC โ ุฎุงุตุฉ ุนูุฏ ุฅูุดุงุก EC ููุฏุงูุฉ โ ุงููุญุฑู ููุฑ ุจู ูุฑุญูุชูู:
// Creation phase (ุฃู: Creation/Memory phase):
// ูููุดุฃ Environment Record.
// ุชุชู "ุฑูุน" (hoisting): ุชุนููู ุฃุณูุงุก ุงูุฏูุงู ุจุงููุงููุ ููููุชุบูุฑุงุช (var) ูุชู ุชุนุฑูููุง ุจุงููููุฉ undefined. ุงููุชุบูุฑุงุช ุจู let/const ุชูุนุฑู ููู ุฏุงุฎู TDZ (Temporal Dead Zone) ุญุชู ูุตู ุชูููุฐ ุชุนุฑูููุง.
// ูุญุฏุฏ ูููุฉ this.
// Execution phase:
// - ุชูููุฐ ุงูููุฏ ุณุทุฑ ุจุณุทุฑ
// ุ ุชุฎุตูุต ุงูููู ุงูุญููููุฉ ูููุชุบูุฑุงุชุ ุชุดุบูู ุงูุชุนุงุจูุฑุ ุฅูุฎ.


// Lexical Environment ูู ุงูุจูุฆุฉ ุงููู ุจูุญุชูู ุนูู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู scope ุงูุญุงูู
// ูุจูููู ุจุชูููุฐ ุงูููุฏ ุจุชุงุนูุง ูู ุงู Lexical Environment ุงูุญุงูู  

// ูู Execution Context ูุญุชูู ุฏุงุฎูู ุนูู Lexical Environment ูุงุญุฏ (ุฃู ุฃูุซุฑ)ุ
// ูุฏู ูู ุงูููุงู ุงููู ุจูุชุฎุฒู ููู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ุชู ุชุนุฑูููุง ูู ูุฐุง ุงูุณูุงู.
// ูุนูู:
// Execution Context = ุงูุตูุฏูู ุงููุจูุฑ ุงููู ุจูุญุชูู ุนูู:
// Lexical Environment โ ููู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ููุฏุฑ ููุตููุง ุจุงูุงุณู.
// Variable Environment (ูู ES5 ูุงูุช ูููุตูุฉุ ุฏูููุชู ุงูุฏูุฌุช ูุน ุงูู Lexical).
// Value of this.

var x = 10;

function foo() {
  var y = 20;

  function bar() {
    var z = 30;
    console.log(x + y + z);
  }

  bar();
}

foo(); // 60

// . ุฅูุดุงุก ุงูู Global Execution Context:
// ูุญุฑู JS ููุดุฆ ุฃูู EC (ุงูู global).
// ุฌูุงู:
// Lexical Environment:
// Environment Record = { x: 10, foo: <function> }
// Outer Reference = null (ูุฃูู ุฌููุจุงู)
// this = window (ูู ุงููุชุตูุญ)
// 2. ุงุณุชุฏุนุงุก foo():
// ููุดุฃ Execution Context ุฌุฏูุฏ ุฎุงุต ุจู foo.
// ุฌูุงู Lexical Environment ุฌุฏูุฏ:
// Environment Record = { y: 20, bar: <function> }
// Outer Reference โ ูุดูุฑ ุฅูู Lexical Environment ุงูุฎุงุต ุจู global.
// this = undefined (ูู strict) ุฃู window (ูู non-strict).
// 3. ุงุณุชุฏุนุงุก bar():
// Execution Context ุซุงูุซ ุฌุฏูุฏ.
// ุฌูุงู Lexical Environment:
// Environment Record = { z: 30 }
// Outer Reference โ ูุดูุฑ ุฅูู LE ุงูุฎุงุต ุจู foo.
// this = undefined ุฃู window.
// 4. ุนูุฏ ุชูููุฐ console.log(x + y + z):
// ุงููุญุฑู ูุจุญุซ ุนู x:
// ูุง ูุฌุฏูุง ูู LE ุงูุฎุงุต ุจู bar โ ูุฐูุจ ุฅูู outer (LE ุงูุฎุงุต ุจู foo).
// ูุง ูุฌุฏูุง ูู foo โ ูุฐูุจ ุฅูู outer (LE ุงูุฎุงุต ุจู global).
// ูุฌุฏูุง ููุงู (x = 10).
// ๐ ูููุฐุง ุงููุญุฑู ูุณุชุฎุฏู ุงูู Lexical Environments chain ููุจุญุซ ุนู ุงููุชุบูุฑุงุช ุฃุซูุงุก ุชูููุฐ ุงูููุฏ ุฏุงุฎู ุงูู Execution Context.

// ุงูุนูุงูุฉ ุงูุชูููุฉ ุงูุฏูููุฉ
// ุงูุนูุตุฑ	ุงูู                           Role
// Execution Context (EC)	        "ุงูุฅุทุงุฑ" ุฃู "ุงูุตูุฏูู" ุงููู ูููุฐ ููู ุงูููุฏ.
// Lexical Environment (LE)	        "ุงูุจูุฆุฉ" ุงููู ุจูุฎุฒู ูููุง ุงููุญุฑู ุงููุชุบูุฑุงุชุ ุงูุฏูุงูุ ูุงูู outer reference.
// EC โ LE	                         ูู EC ุนูุฏ ุฅูุดุงุฆู ุจููุดุฆ ูุนู LE ุฎุงุต ุจู.
// LE โ outer	                      ูู LE ุนูุฏ ุฅูุดุงุฆู ุจูุญุชูุธ ุจุฅุดุงุฑุฉ ุฅูู ุงูู LE ุงูุฎุงุฑุฌู (ูู ููุงู ุชุนุฑูู ุงูููุฏุ ูุด ููุงู ุงูุชูููุฐ).

// ูุซุงู ุนูู ุงููุฑู ุจูู ุงูุชุนุฑูู ูุงูุชูููุฐ
function outer() {
  const a = 10;

  function inner() {
    console.log(a);
  }

  return inner;
}

const fn = outer(); // ููุง ุงุชูุดุฃ LE ูู outer ูููู a=10
fn(); // ุชูููุฐ inner ุฏุงุฎู EC ุฌุฏูุฏ ููู LE outer ูุณู ูุชุฎุฒู ูู ุงูุฐุงูุฑุฉ (closure)

// ููุง inner ุงุชุนุฑููุชุ ูุงูุช ููุฌูุฏุฉ ุฏุงุฎู Lexical Environment ูู outer.
// ูู inner ุชุญุชูุธ ุจู Reference ููู outer LE ุญุชู ุจุนุฏ ูุง outer ุฎูุต.
// ูุฐูู a ูุง ุฒุงูุช ูุชุงุญุฉ ูู inner (ูุฏู ูู ุงูู Closure).



// Global Execution Context ุงูู ูู ุงู ุ
// ุงู Global Execution Context ูู ุงู Execution Context ุงูุงูุชุฑุงุถู ุงููู ุจูุชู ุงูุดุงุคู ููุง ุจูุชู ุชูููุฐ ุงูููุฏ ุจุชุงุนู
// ูุจูุญุชูู ุนูู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู global scope
// ูุจูุชู ุงูุดุงุก Global Execution Context ูุงุญุฏ ุจุณ ูู ุงูุจุฑูุงูุฌ ุจุชุงุนู
// ูุจูุจูู ููุฌูุฏ ุทูู ูุง ุงูุจุฑูุงูุฌ ุดุบุงู

// ) Global Execution Context (GEC) โ ุดุฑุญ ุนููู
// ูููุดุฃ ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ุจุฏุงูุฉ ุชุญููู ุงูู script.
// ูุญุชูู ุนูู:
// Global object (window ูู ุงููุชุตูุญุ global ูู Nodeุ ูglobalThis ููุญุฏ).
// Global lexical environment: Environment Record ูุญูู ูุชุบูุฑุงุช ู ุฏูุงู ุงูุฅุนูุงู ุงูุนุงูููุฉ.


// ูุซุงู ุชูุถูุญู
console.log("Start of the program");
let name = "John";
function sayHello() {
    console.log("Hello, " + name);
}
sayHello();
console.log("End of the program");

// ุงูุชุฑุชูุจ ุงููุชููุน ููุทุจุงุนุฉ:
// Start of the program
// Hello, John
// End of the program
// ูู ุงููุซุงู ุนูุฏู ููุฏ ุจูุชููุฐ ูู ุงู Global Execution Context
// ุงูู ุญุงุฌุฉ ุจุชุชููุฐ ูู console.log("Start of the program");
// ูุฏู ุจุชุชููุฐ ูู ุงู Global Execution Context ูุงููุง ูุด ุฌูุง ุฏุงูุฉ
// ุจุนุฏ ูุฏู ุจูุชู ุชุนุฑูู ุงููุชุบูุฑ name ูุงูุฏุงูุฉ sayHello ูู ุงู Global Execution Context
// ุจุนุฏ ูุฏู ุจูุชู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ sayHello
// ูุฏู ุจูุคุฏู ุงูู ุงูุดุงุก Execution Context ุฌุฏูุฏ ููุฏุงูุฉ sayHello
// ูุจูุชู ุชูููุฐ ุงูููุฏ ุจุชุงุนูุง ูู ุงู Execution Context ุงูุฌุฏูุฏ
// ุงูู ุญุงุฌุฉ ุจุชุชููุฐ ูู console.log("Hello, " + name);
// ูุฏู ุจุชุชููุฐ ูู ุงู Execution Context ุจุชุงุน ุงูุฏุงูุฉ sayHello
// ูุจุชูุฏุฑ ุชูุตู ูููุชุบูุฑ name ูุงู ุงู Execution Context ุจุชุงุน ุงูุฏุงูุฉ sayHello
// ุจูุญุชูู ุนูู Lexical Environment ุงููู ุจูุญุชูู ุนูู ุงููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู scope ุงูุญุงูู
// ูุจููุฏุฑ ููุตู ูููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู Global Execution Context ูุงููุง ูู ุงู scope ุงูุงุนูู
// ุจุนุฏ ูุฏู ุจูุชู ุชูููุฐ console.log("End of the program");
// ูุฏู ุจุชุชููุฐ ูู ุงู Global Execution Context ูุงููุง ูุด ุฌูุง ุฏุงูุฉ
// ูุฏู ุจูููู ุชูููุฐ ุงูููุฏ ุจุชุงุนู ูู ุงู Global Execution Context


// ููุญูุธุฉ ูููุฉ
// ุงู Execution Context ุจูุชู ุงูุดุงุคู ูุชูููุฐู ูู ูุธุงู ุงู call stack
// ูุนูู ููุง ุจูุชู ุงุณุชุฏุนุงุก ุฏุงูุฉ ุจุชุชูุดุฃ Execution Context ุฌุฏูุฏ ูุจูุชุถุงู ูู ุงู call stack
// ูููุง ุงูุฏุงูุฉ ุชุฎูุต ุชูููุฐูุง Execution Context ุจุชุงุนูุง ุจูุชุดุงู ูู ุงู call stack
// ูุฏู ุจูุฎูู ุงู Execution Contexts ุจุชูุธู ููุณูุง ุจุดูู ุชููุงุฆู ูู ูุธุงู ุงู call stack



// Lexical Environment Reference ุงูู ูู ุงู ุ
// ุงู Lexical Environment Reference ูู ุงูุงุดุงุฑุฉ ุงููู ุจูุญุชูุธ ุจููุง ุงู Lexical Environment ูู Lexical Environment ุงูุฎุงุฑุฌู
// ูุฏู ุจูุณูุญ ูู Lexical Environment ุงูุญุงูู ุงูู ููุตู ูููุชุบูุฑุงุช ูุงูุฏูุงู ุงููู ูู ุงู scope ุงูุงุนูู
// ูุจูุชู ุงูุดุงุก Lexical Environment Reference ุฌุฏูุฏ ููู ุฏุงูุฉ ุจุชุชููุฐ ูู ุงูุจุฑูุงูุฌ ุจุชุงุนู
// ูุจูููู ุจุชูููุฐ ุงูููุฏ ุจุชุงุนูุง ูู ุงู Lexical Environment ุงูุญุงูู


// ูู Execution Context (ุณูุงุก Global ุฃู Function) ุจูุญุชูู ุนูู ููููู ุฑุฆูุณู ุงุณูู:
// ๐ธ LexicalEnvironment = { EnvironmentRecord, OuterReference }
// EnvironmentRecord: ุฏู ุงูููุงู ุงููู ุจูุฎุฒู ุงููุชุบูุฑุงุช ุงููู ุงุชุนุฑูุช ุฌูู ุงูุณูุงู ุฏู (ุฒู let, const, var, ูุงูุฏูุงู ุงููุนุฑูุฉ ุฏุงุฎูู).
// OuterReference: ุฏู ุฑุงุจุท pointer ุฅูู Lexical Environment ุขุฎุฑ โ ุนุงุฏุฉู ุงูุจูุฆุฉ ุงููู ูุงูุช "ูุดูุทุฉ" ููุช ูุง ุชู ุฅูุดุงุก ุงูุฏุงูุฉ.
// ุจูุนูู ุจุณูุท:
// ูู ุฏุงูุฉ โุจุชุชููุฏโ (ูุนูู ุจูุชูุชุจ ุชุนุฑูููุง) ููู ูุงุณูุฉ ูุนุงูุง pointer (ูุฑุฌุน) ููู scope ุงููู ุงุชูุชุจุช ููู.

// function outer() {
//   const a = 10;

//   function inner() {
//     console.log(a);
//   }

//   return inner;
// }

// const fn = outer();
// fn(); // 10


// ูุง ูุญุฏุซ ุฎุทูุฉ ุจุฎุทูุฉ:
//     ุนูุฏ ุชุญููู ุงูููุฏุ JavaScript ุจุชุนูู Global Execution Context (GEC).
//    ุฃุซูุงุก ุชูููุฐ outer():
//         ุจูุชููู Execution Context ุฌุฏูุฏ ูู outer.
//         ุฌูู ุงูู outer, ุจูุชุนุฑู ูุชุบูุฑ a = 10.
//         ุซู ุชููุดุฃ ุฏุงูุฉ ุฌุฏูุฏุฉ inner.
// ๐น ุงูููู:
// ุนูุฏ ุฅูุดุงุก innerุ ุงููุญุฑู ูุณุฌู ูุนุงูุง ุงููุฑุฌุน (pointer) ุฅูู ุงูู Lexical Environment ุงูุฎุงุต ุจู outer โ ูุฃู inner "ุงุชูุชุจุช" ุฌูู outer.
//     ููุง outer() ุชูุชููุ ุนุงุฏุฉู ุงูู EC ุจุชุงุนูุง ูุชุดุงู ูู ุงูู stack.
//     ููู โฆ ูู ุงูุญุงูุฉ ุฏูุ
//     inner (ุงููู ุฑุฌุนูุงูุง) ูุงุฒุงูุช ููุฌูุฏุฉ ูู ุงููุชุบูุฑ fn.
//     ูุฃู inner ุนูุฏูุง reference ุฅูู LE ุงูุฎุงุต ุจู outerุ
//     ูู ูุฐุง ุงูู environment ูุด ุจูุชุญุฐู ูู ุงูุฐุงูุฑุฉ.
// ูุชูุฌุฉ:
//     ุงูู Outer LE (ุงููู ููู a=10) ููุถู ุนุงูุด ูู ุงูุฐุงูุฑุฉุ ูุฑุจูุท ุจุงูู Inner function.
// ูุฏู ุงููู ุจูุณููู: Closure

// ๐ ุงูุดูู ุงูุชุฎุทูุทู ุงูุจุณูุท:
// Global LE
//  โโโ outer() EC
//        โ
//        โโ EnvironmentRecord: { a: 10 }
//        โ
//        โโ OuterReference โ Global LE
//               โ
//         inner() EC
//           EnvironmentRecord: {}
//           OuterReference โ (LE ูู outer)

// ๐ง ููู ุงููุฑุฌุน ุจููุถู ููุฌูุฏ (ูููู ุฃููุงุช ุจูุชูุทุน)
// ุงูุญุงูุฉ 1๏ธโฃ: ุงููุฑุฌุน ููุถู ููุฌูุฏ โ ููุง ูู Closure ูุดุท
// ูุนูู ููู ุฏุงูุฉ ุฏุงุฎููุฉ ูุณู โุญูุฉโ (ูููุด GC ููุฏุฑ ููุณุญูุง) ูุฃููุง ูุชุฎุฒูุฉ ูู ูุชุบูุฑ ุฃู ูุณุชุฎุฏูุฉ ูู ูููุจุงู ุฃู ุญุฏุซ.
// ุจุงูุชุงูู ุงูุจูุฆุฉ ุงูุฎุงุฑุฌูุฉ (outer lexical env) ุจุชูุถู "reachable".
// ูุซุงู:

// function makeCounter() {
//   let count = 0;
//   return function() {
//     count++;
//     return count;
//   };
// }

// const c1 = makeCounter(); // ุงูู inner function ูุณู ููุฌูุฏ
// c1(); // count = 1

// () ุฎูุตุ ููู count ูุณู ูู ุงูุฐุงูุฑุฉ ูุฃู c1 (ุงููู ูู ุงูู inner function) ุดุงููู.

// ุงูุญุงูุฉ 2๏ธโฃ: ุงููุฑุฌุน ูุชูุทุน (ููุฒุงู ูู ุงูุฐุงูุฑุฉ)
// ูู ุงูุฏุงูุฉ ุงูุฏุงุฎููุฉ ูุด ูุชุฎุฒูุฉ ูู ุฃู ูุชุบูุฑุ ุฃู ูููุด ุฃู ูุงุฆู ุดุงูููุงุ ุงููุญุฑู ููุฏุฑ ููุณุญูุง ูุงูู LE ุงููุฑุชุจุท ุจููุง.
// ูุซุงู:

// function outer() {
//   const x = 42;
//   function inner() { console.log(x); }
//   inner(); // ูุงุฏููุงูุง ูุจุงุดุฑุฉ
// }
// outer(); // ุจุนุฏ ุงูุชูููุฐ ุฎูุงุตุ ูุง inner ููุง outer ูููู ุฃู ูุฑุฌุน

// () ุงุชููุฐุช ูุฑูุฌุนุช ูููุชูุง undefined.
// ุจุนุฏ ุงูุชูุงุก outer()ุ ูููุด ุฃู ูุชุบูุฑ ุดุงูู innerุ ูุจุงูุชุงูู:
// ุงูู inner function ููุณูุง ุชูุฒุงู.
// ูุงูู Lexical Environment ุงูุฎุงุต ุจู outer ูุชู ุญุฐูู ุจุงููุงูู (ูุฃู ูุญุฏุด ุดุงููู).

// ููู ูุชู ุชุฎุฒูู ุงููุฑุฌุน ูุนูููุง (ููููู ุฏุงุฎูู)
// ูู ุงููุงุญูุฉ ุงูุชูููุฉุ ุงูู JavaScript Engine (ุฒู V8) ุจูุญุชูุธ ุจู hidden reference (pointer) ูู ุงูุฏุงูุฉ ููู outer scope.
// ูุฐุง pointer ุจูุดูุฑ ุฅูู ุณูุณูุฉ ูู ุงููุงุฆูุงุช ุงูุฏุงุฎููุฉ ุชูุซู ุงูู environments.
// ุนูุฏ ุงูุจุญุซ ุนู ูุชุบูุฑ (resolution)ุ ุงููุญุฑู ูุจุฏุฃ ูู environment ุงูุญุงูู ูููุดู ุนุจุฑ ุงูู pointers ูุญุฏ ูุง ููุงูู ุงููุชุบูุฑ.
// ูุฐุง ูุณูู: Scope Chain Lookup

// ูุซุงู ููุถุญ ุงูู โุงููุตุงู ุงููุฑุฌุนโ ุจุดูู ุนููู
// function outer() {
//   let value = 100;
//   return function inner() {
//     console.log(value);
//   };
// }

// let ref = outer();
// ref();   // 100

// ref = null;  // ูุทุนูุง ุขุฎุฑ ูุฑุฌุน ูู inner
// // ุงูุขู GC ููุญุฐู inner ูุงูู outer LE ูุนุงู

// ููุง ุชุนูู ref = null, ุงูู closure ูุง ุนุงุฏุด ููู ูุฑุฌุน.
// ุจุงูุชุงููุ Garbage Collector ููุญุฐู:
// ุงูู inner function object
// ูุงูู outer LE ุงููุฑุชุจุท ุจูู
// ูุงูู value = 100
// ๐ฌ ููุฎุต ููููู ุงูุงุฑุชุจุงุท
// ุงูุญุงูุฉ	ูุงุฐุง ูุญุฏุซ ููู outer lexical environment
// inner function ูุงุฒุงูุช ููุฌูุฏุฉ (ูู ูุชุบูุฑ / ุญุฏุซ / ูููุจุงู)	ุชุจูู ุงูุจูุฆุฉ ูู ุงูุฐุงูุฑุฉ
// inner function ุงูุชูุช ููููุด ูุฑุฌุน ูููุง	ุงูุจูุฆุฉ ุชูุญุฐู
// inner function ุงุชูุชุจุช ุฌูู outer ููููุง ุงุชููุฐุช ุฌูู ููุณ ุงูุฅุทุงุฑ ููููุด ุชุฎุฒูู ุฎุงุฑุฌู	ุงูุจูุฆุฉ ุชูุญุฐู ุจุนุฏ ุงูุชูููุฐ